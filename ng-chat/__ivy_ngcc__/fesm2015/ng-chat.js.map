{"version":3,"file":"ng-chat.js","sources":["../core/chat-adapter.ts","../core/message-type.enum.ts","../core/message.ts","../core/chat-participant-status.enum.ts","../core/chat-participant-type.enum.ts","../core/user.ts","../core/participant-response.ts","../core/participant-metadata.ts","../core/window.ts","../core/paged-history-chat-adapter.ts","../core/theme.enum.ts","../core/guid.ts","../core/group.ts","../core/scroll-direction.enum.ts","../core/default-file-upload-adapter.ts","../ng-chat.component.ts","../pipes/emojify.pipe.ts","../pipes/linkfy.pipe.ts","../pipes/sanitize.pipe.ts","../pipes/group-message-display-name.pipe.ts","../components/ng-chat-options/ng-chat-options.component.ts","../core/message-counter.ts","../core/chat-participant-status-descriptor.ts","../components/ng-chat-friends-list/ng-chat-friends-list.component.ts","../components/ng-chat-window/ng-chat-window.component.ts","../ng-chat.module.ts","../../ng-chat.ts"],"names":[],"mappings":"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","sourcesContent":["import { Observable } from 'rxjs';\r\nimport { Message } from \"./message\";\r\nimport { User } from \"./user\";\r\nimport { ParticipantResponse } from \"./participant-response\";\r\nimport { IChatParticipant } from './chat-participant';\r\n\r\nexport abstract class ChatAdapter\r\n{\r\n    // ### Abstract adapter methods ###\r\n\r\n    public abstract listFriends(): Observable<ParticipantResponse[]>;\r\n    \r\n    public abstract getMessageHistory(destinataryId: any): Observable<Message[]>;\r\n\r\n    public abstract sendMessage(message: Message): void;\r\n\r\n    // ### Adapter/Chat income/ingress events ###\r\n\r\n    public onFriendsListChanged(participantsResponse: ParticipantResponse[]): void\r\n    {\r\n        this.friendsListChangedHandler(participantsResponse);\r\n    }\r\n\r\n    public onMessageReceived(participant: IChatParticipant, message: Message): void\r\n    {\r\n        this.messageReceivedHandler(participant, message);\r\n    }\r\n    \r\n    // Event handlers\r\n    /** @internal */\r\n    friendsListChangedHandler: (participantsResponse: ParticipantResponse[]) => void  = (participantsResponse: ParticipantResponse[]) => {};\r\n    /** @internal */\r\n    messageReceivedHandler: (participant: IChatParticipant, message: Message) => void = (participant: IChatParticipant, message: Message) => {};\r\n}\r\n","export enum MessageType\r\n{\r\n    Text = 1,\r\n    File = 2,\r\n    Image = 3\r\n}\r\n","import { MessageType } from './message-type.enum';\r\n\r\nexport class Message\r\n{\r\n    public type?: MessageType = MessageType.Text;\r\n    public fromId: any;\r\n    public toId: any;\r\n    public message: string;\r\n    public dateSent?: Date;\r\n    public dateSeen?: Date;\r\n}\r\n","export enum ChatParticipantStatus\r\n{\r\n    Online,\r\n    Busy,\r\n    Away,\r\n    Offline\r\n}\r\n","export enum ChatParticipantType\r\n{\r\n    User,\r\n    Group\r\n}\r\n","import { ChatParticipantStatus } from \"./chat-participant-status.enum\";\r\nimport { IChatParticipant } from \"./chat-participant\";\r\nimport { ChatParticipantType } from \"./chat-participant-type.enum\";\r\n\r\nexport class User implements IChatParticipant\r\n{\r\n    public readonly participantType: ChatParticipantType = ChatParticipantType.User;\r\n    public id: any;\r\n    public displayName: string;\r\n    public status: ChatParticipantStatus;\r\n    public avatar: string;\r\n}\r\n","import { User } from \"./user\";\r\nimport { ParticipantMetadata } from \"./participant-metadata\";\r\nimport { IChatParticipant } from \"./chat-participant\";\r\n\r\nexport class ParticipantResponse\r\n{\r\n    public participant: IChatParticipant;\r\n    public metadata: ParticipantMetadata;\r\n}\r\n","export class ParticipantMetadata\r\n{\r\n    public totalUnreadMessages: number = 0;\r\n}\r\n","import { Message } from \"./message\";\r\nimport { User } from \"./user\";\r\nimport { ChatParticipantType } from \"./chat-participant-type.enum\";\r\nimport { ChatParticipantStatus } from \"./chat-participant-status.enum\";\r\nimport { Group } from \"./group\";\r\nimport { IChatParticipant } from \"./chat-participant\";\r\n\r\nexport class Window\r\n{\r\n    constructor(participant: IChatParticipant, isLoadingHistory: boolean, isCollapsed: boolean)\r\n    {\r\n        this.participant = participant;\r\n        this.messages =  [];\r\n        this.isLoadingHistory = isLoadingHistory;\r\n        this.hasFocus = false; // This will be triggered when the 'newMessage' input gets the current focus\r\n        this.isCollapsed = isCollapsed;\r\n        this.hasMoreMessages = false;\r\n        this.historyPage = 0;\r\n    }\r\n\r\n    public participant: IChatParticipant;    \r\n    public messages: Message[] = [];\r\n    public newMessage?: string = \"\";\r\n\r\n    // UI Behavior properties\r\n    public isCollapsed?: boolean = false; \r\n    public isLoadingHistory: boolean = false;\r\n    public hasFocus: boolean = false;\r\n    public hasMoreMessages: boolean = true;\r\n    public historyPage: number = 0;\r\n}\r\n","import { Observable } from 'rxjs';\r\nimport { Message } from \"./message\";\r\nimport { User } from \"./user\";\r\nimport { ChatAdapter } from \"./chat-adapter\";\r\n\r\n/**\r\n * @description Chat Adapter decorator class that adds pagination to load the history of messagesr. \r\n * You will need an existing @see ChatAdapter implementation\r\n */\r\nexport abstract class PagedHistoryChatAdapter extends ChatAdapter\r\n{   \r\n    abstract getMessageHistoryByPage(destinataryId: any, size: number, page: number) : Observable<Message[]>;\r\n}\r\n","export enum Theme\r\n{\r\n    Custom = 'custom-theme',\r\n    Light = 'light-theme',\r\n    Dark = 'dark-theme'\r\n}\r\n","// Poached from: https://github.com/Steve-Fenton/TypeScriptUtilities\r\n// @dynamic\r\nexport class Guid {\r\n    static newGuid() {\r\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n            var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);\r\n            return v.toString(16);\r\n        });\r\n    }\r\n}\r\n","import { Guid } from \"./guid\";\r\nimport { User } from \"./user\";\r\nimport { ChatParticipantStatus } from \"./chat-participant-status.enum\";\r\nimport { IChatParticipant } from \"./chat-participant\";\r\nimport { ChatParticipantType } from \"./chat-participant-type.enum\";\r\n\r\nexport class Group implements IChatParticipant\r\n{\r\n    constructor(participants: User[])\r\n    {   \r\n        this.chattingTo = participants;\r\n        this.status = ChatParticipantStatus.Online;\r\n\r\n        // TODO: Add some customization for this in future releases\r\n        this.displayName = participants.map((p) => p.displayName).sort((first, second) => second > first ? -1 : 1).join(\", \");\r\n    }\r\n\r\n    public id: string = Guid.newGuid();\r\n    public chattingTo: User[];\r\n\r\n    public readonly participantType: ChatParticipantType = ChatParticipantType.Group;\r\n\r\n    public status: ChatParticipantStatus;\r\n    public avatar: string | null;\r\n    public displayName: string;\r\n}\r\n","export enum ScrollDirection {\r\n    Top,\r\n    Bottom\r\n}","import { IFileUploadAdapter } from './file-upload-adapter';\r\nimport { HttpClient, HttpRequest, HttpEventType, HttpResponse, HttpHeaders } from '@angular/common/http';\r\nimport { Observable, Subject } from 'rxjs';\r\nimport { User } from './user';\r\nimport { Message } from './message';\r\n\r\nexport class DefaultFileUploadAdapter implements IFileUploadAdapter\r\n{\r\n    /**\r\n     * @summary Basic file upload adapter implementation for HTTP request form file consumption\r\n     * @param _serverEndpointUrl The API endpoint full qualified address that will receive a form file to process and return the metadata.\r\n     */\r\n    constructor(private _serverEndpointUrl: string, private _http: HttpClient) {\r\n    }\r\n\r\n    uploadFile(file: File, participantId: any): Observable<Message> {\r\n        const formData: FormData = new FormData();\r\n\r\n        //formData.append('ng-chat-sender-userid', currentUserId);\r\n        formData.append('ng-chat-participant-id', participantId);\r\n        formData.append('file', file, file.name);\r\n\r\n        return this._http.post<Message>(this._serverEndpointUrl, formData);\r\n\r\n        // TODO: Leaving this if we want to track upload progress in detail in the future. Might need a different Subject generic type wrapper\r\n        // const fileRequest = new HttpRequest('POST', this._serverEndpointUrl, formData, {\r\n        //     reportProgress: true\r\n        // });\r\n\r\n        // const uploadProgress = new Subject<number>();\r\n        // const uploadStatus = uploadProgress.asObservable();\r\n\r\n        //const responsePromise = new Subject<Message>();\r\n\r\n        // this._http\r\n        //     .request(fileRequest)\r\n        //     .subscribe(event => {\r\n        //         // if (event.type == HttpEventType.UploadProgress)\r\n        //         // {\r\n        //         //     const percentDone = Math.round(100 * event.loaded / event.total);\r\n\r\n        //         //     uploadProgress.next(percentDone);\r\n        //         // }\r\n        //         // else if (event instanceof HttpResponse)\r\n        //         // {\r\n                    \r\n        //         //     uploadProgress.complete();\r\n        //         // }\r\n        //     });\r\n    }\r\n}\r\n","import { Component, Input, OnInit, ViewChildren, QueryList, HostListener, Output, EventEmitter, ViewEncapsulation } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\n\r\nimport { ChatAdapter } from './core/chat-adapter';\r\nimport { IChatGroupAdapter } from './core/chat-group-adapter';\r\nimport { User } from \"./core/user\";\r\nimport { ParticipantResponse } from \"./core/participant-response\";\r\nimport { Message } from \"./core/message\";\r\nimport { MessageType } from \"./core/message-type.enum\";\r\nimport { Window } from \"./core/window\";\r\nimport { ChatParticipantStatus } from \"./core/chat-participant-status.enum\";\r\nimport { ScrollDirection } from \"./core/scroll-direction.enum\";\r\nimport { Localization, StatusDescription } from './core/localization';\r\nimport { IChatController } from './core/chat-controller';\r\nimport { PagedHistoryChatAdapter } from './core/paged-history-chat-adapter';\r\nimport { IFileUploadAdapter } from './core/file-upload-adapter';\r\nimport { DefaultFileUploadAdapter } from './core/default-file-upload-adapter';\r\nimport { Theme } from './core/theme.enum';\r\nimport { IChatOption } from './core/chat-option';\r\nimport { Group } from \"./core/group\";\r\nimport { ChatParticipantType } from \"./core/chat-participant-type.enum\";\r\nimport { IChatParticipant } from \"./core/chat-participant\";\r\n\r\nimport { map } from 'rxjs/operators';\r\nimport { NgChatWindowComponent } from './components/ng-chat-window/ng-chat-window.component';\r\n\r\n@Component({\r\n    selector: 'ng-chat',\r\n    templateUrl: 'ng-chat.component.html',\r\n    styleUrls: [\r\n        'assets/icons.css',\r\n        'assets/loading-spinner.css',\r\n        'assets/ng-chat.component.default.css',\r\n        'assets/themes/ng-chat.theme.default.scss',\r\n        'assets/themes/ng-chat.theme.dark.scss'\r\n    ],\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\n\r\nexport class NgChat implements OnInit, IChatController {\r\n    constructor(private _httpClient: HttpClient) { }\r\n\r\n    // Exposes enums for the ng-template\r\n    public ChatParticipantType = ChatParticipantType;\r\n    public ChatParticipantStatus = ChatParticipantStatus;\r\n    public MessageType = MessageType;\r\n\r\n    private _isDisabled: boolean = false;\r\n\r\n    get isDisabled(): boolean {\r\n        return this._isDisabled;\r\n    }\r\n\r\n    @Input()\r\n    set isDisabled(value: boolean) {\r\n        this._isDisabled = value;\r\n\r\n        if (value)\r\n        {\r\n            // To address issue https://github.com/rpaschoal/ng-chat/issues/120\r\n            window.clearInterval(this.pollingIntervalWindowInstance)\r\n        }\r\n        else\r\n        {\r\n            this.activateFriendListFetch();\r\n        }\r\n    }\r\n\r\n    @Input()\r\n    public adapter: ChatAdapter;\r\n\r\n    @Input()\r\n    public groupAdapter: IChatGroupAdapter;\r\n\r\n    @Input()\r\n    public userId: any;\r\n\r\n    @Input()\r\n    public isCollapsed: boolean = false;\r\n\r\n    @Input()\r\n    public maximizeWindowOnNewMessage: boolean = true;\r\n\r\n    @Input()\r\n    public pollFriendsList: boolean = false;\r\n\r\n    @Input()\r\n    public pollingInterval: number = 5000;\r\n\r\n    @Input()\r\n    public historyEnabled: boolean = true;\r\n\r\n    @Input()\r\n    public emojisEnabled: boolean = true;\r\n\r\n    @Input()\r\n    public linkfyEnabled: boolean = true;\r\n\r\n    @Input()\r\n    public audioEnabled: boolean = true;\r\n\r\n    @Input()\r\n    public searchEnabled: boolean = true;\r\n\r\n    @Input() // TODO: This might need a better content strategy\r\n    public audioSource: string = 'https://raw.githubusercontent.com/rpaschoal/ng-chat/master/src/ng-chat/assets/notification.wav';\r\n\r\n    @Input()\r\n    public persistWindowsState: boolean = true;\r\n\r\n    @Input()\r\n    public title: string = \"Friends\";\r\n\r\n    @Input()\r\n    public messagePlaceholder: string = \"Type a message\";\r\n\r\n    @Input()\r\n    public searchPlaceholder: string = \"Search\";\r\n\r\n    @Input()\r\n    public browserNotificationsEnabled: boolean = true;\r\n\r\n    @Input() // TODO: This might need a better content strategy\r\n    public browserNotificationIconSource: string = 'https://raw.githubusercontent.com/rpaschoal/ng-chat/master/src/ng-chat/assets/notification.png';\r\n\r\n    @Input()\r\n    public browserNotificationTitle: string = \"New message from\";\r\n\r\n    @Input()\r\n    public historyPageSize: number = 10;\r\n\r\n    @Input()\r\n    public localization: Localization;\r\n\r\n    @Input()\r\n    public hideFriendsList: boolean = false;\r\n\r\n    @Input()\r\n    public hideFriendsListOnUnsupportedViewport: boolean = true;\r\n\r\n    @Input()\r\n    public fileUploadUrl: string;\r\n\r\n    @Input()\r\n    public theme: Theme = Theme.Light;\r\n\r\n    @Input()\r\n    public customTheme: string;\r\n\r\n    @Input()\r\n    public messageDatePipeFormat: string = \"short\";\r\n\r\n    @Input()\r\n    public showMessageDate: boolean = true;\r\n\r\n    @Input()\r\n    public isViewportOnMobileEnabled: boolean = false;\r\n\r\n    @Input()\r\n    public fileUploadAdapter: IFileUploadAdapter;\r\n\r\n    @Output()\r\n    public onParticipantClicked: EventEmitter<IChatParticipant> = new EventEmitter<IChatParticipant>();\r\n\r\n    @Output()\r\n    public onParticipantChatOpened: EventEmitter<IChatParticipant> = new EventEmitter<IChatParticipant>();\r\n\r\n    @Output()\r\n    public onParticipantChatClosed: EventEmitter<IChatParticipant> = new EventEmitter<IChatParticipant>();\r\n\r\n    @Output()\r\n    public onMessagesSeen: EventEmitter<Message[]> = new EventEmitter<Message[]>();\r\n\r\n    private browserNotificationsBootstrapped: boolean = false;\r\n\r\n    public hasPagedHistory: boolean = false;\r\n\r\n    // Don't want to add this as a setting to simplify usage. Previous placeholder and title settings available to be used, or use full Localization object.\r\n    private statusDescription: StatusDescription = {\r\n        online: 'Online',\r\n        busy: 'Busy',\r\n        away: 'Away',\r\n        offline: 'Offline'\r\n    };\r\n\r\n    private audioFile: HTMLAudioElement;\r\n\r\n    public participants: IChatParticipant[];\r\n\r\n    public participantsResponse: ParticipantResponse[];\r\n\r\n    public participantsInteractedWith: IChatParticipant[] = [];\r\n\r\n    public currentActiveOption: IChatOption | null;\r\n\r\n    private pollingIntervalWindowInstance: number;\r\n\r\n    private get localStorageKey(): string\r\n    {\r\n        return `ng-chat-users-${this.userId}`; // Appending the user id so the state is unique per user in a computer.\r\n    };\r\n\r\n    // Defines the size of each opened window to calculate how many windows can be opened on the viewport at the same time.\r\n    public windowSizeFactor: number = 320;\r\n\r\n    // Total width size of the friends list section\r\n    public friendsListWidth: number = 262;\r\n\r\n    // Available area to render the plugin\r\n    private viewPortTotalArea: number;\r\n\r\n    // Set to true if there is no space to display at least one chat window and 'hideFriendsListOnUnsupportedViewport' is true\r\n    public unsupportedViewport: boolean = false;\r\n\r\n    windows: Window[] = [];\r\n    isBootstrapped: boolean = false;\r\n\r\n    @ViewChildren('chatWindow') chatWindows: QueryList<NgChatWindowComponent>;\r\n\r\n    ngOnInit() {\r\n        this.bootstrapChat();\r\n    }\r\n\r\n    @HostListener('window:resize', ['$event'])\r\n    onResize(event: any){\r\n       this.viewPortTotalArea = event.target.innerWidth;\r\n\r\n       this.NormalizeWindows();\r\n    }\r\n\r\n    // Checks if there are more opened windows than the view port can display\r\n    private NormalizeWindows(): void\r\n    {\r\n        const maxSupportedOpenedWindows = Math.floor((this.viewPortTotalArea - (!this.hideFriendsList ? this.friendsListWidth : 0)) / this.windowSizeFactor);\r\n        const difference = this.windows.length - maxSupportedOpenedWindows;\r\n\r\n        if (difference >= 0)\r\n        {\r\n            this.windows.splice(this.windows.length - difference);\r\n        }\r\n\r\n        this.updateWindowsState(this.windows);\r\n\r\n        // Viewport should have space for at least one chat window but should show in mobile if option is enabled.\r\n        this.unsupportedViewport = this.isViewportOnMobileEnabled? false : this.hideFriendsListOnUnsupportedViewport && maxSupportedOpenedWindows < 1;\r\n    }\r\n\r\n    // Initializes the chat plugin and the messaging adapter\r\n    private bootstrapChat(): void\r\n    {\r\n        let initializationException = null;\r\n\r\n        if (this.adapter != null && this.userId != null)\r\n        {\r\n            try\r\n            {\r\n                this.viewPortTotalArea = window.innerWidth;\r\n\r\n                this.initializeTheme();\r\n                this.initializeDefaultText();\r\n                this.initializeBrowserNotifications();\r\n\r\n                // Binding event listeners\r\n                this.adapter.messageReceivedHandler = (participant, msg) => this.onMessageReceived(participant, msg);\r\n                this.adapter.friendsListChangedHandler = (participantsResponse) => this.onFriendsListChanged(participantsResponse);\r\n\r\n                this.activateFriendListFetch();\r\n\r\n                this.bufferAudioFile();\r\n\r\n                this.hasPagedHistory = this.adapter instanceof PagedHistoryChatAdapter;\r\n\r\n                if (this.fileUploadUrl && this.fileUploadUrl !== \"\")\r\n                {\r\n                    this.fileUploadAdapter = new DefaultFileUploadAdapter(this.fileUploadUrl, this._httpClient);\r\n                }\r\n\r\n                this.NormalizeWindows();\r\n\r\n                this.isBootstrapped = true;\r\n            }\r\n            catch(ex)\r\n            {\r\n                initializationException = ex;\r\n            }\r\n        }\r\n\r\n        if (!this.isBootstrapped){\r\n            console.error(\"ng-chat component couldn't be bootstrapped.\");\r\n\r\n            if (this.userId == null){\r\n                console.error(\"ng-chat can't be initialized without an user id. Please make sure you've provided an userId as a parameter of the ng-chat component.\");\r\n            }\r\n            if (this.adapter == null){\r\n                console.error(\"ng-chat can't be bootstrapped without a ChatAdapter. Please make sure you've provided a ChatAdapter implementation as a parameter of the ng-chat component.\");\r\n            }\r\n            if (initializationException)\r\n            {\r\n                console.error(`An exception has occurred while initializing ng-chat. Details: ${initializationException.message}`);\r\n                console.error(initializationException);\r\n            }\r\n        }\r\n    }\r\n\r\n    private activateFriendListFetch(): void {\r\n        if (this.adapter)\r\n        {\r\n            // Loading current users list\r\n            if (this.pollFriendsList){\r\n                // Setting a long poll interval to update the friends list\r\n                this.fetchFriendsList(true);\r\n                this.pollingIntervalWindowInstance = window.setInterval(() => this.fetchFriendsList(false), this.pollingInterval);\r\n            }\r\n            else\r\n            {\r\n                // Since polling was disabled, a friends list update mechanism will have to be implemented in the ChatAdapter.\r\n                this.fetchFriendsList(true);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Initializes browser notifications\r\n    private async initializeBrowserNotifications()\r\n    {\r\n        if (this.browserNotificationsEnabled && (\"Notification\" in window))\r\n        {\r\n            if (await Notification.requestPermission() === \"granted\")\r\n            {\r\n                this.browserNotificationsBootstrapped = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    // Initializes default text\r\n    private initializeDefaultText() : void\r\n    {\r\n        if (!this.localization)\r\n        {\r\n            this.localization = {\r\n                messagePlaceholder: this.messagePlaceholder,\r\n                searchPlaceholder: this.searchPlaceholder,\r\n                title: this.title,\r\n                statusDescription: this.statusDescription,\r\n                browserNotificationTitle: this.browserNotificationTitle,\r\n                loadMessageHistoryPlaceholder: \"Load older messages\"\r\n            };\r\n        }\r\n    }\r\n\r\n    private initializeTheme(): void\r\n    {\r\n        if (this.customTheme)\r\n        {\r\n            this.theme = Theme.Custom;\r\n        }\r\n        else if (this.theme != Theme.Light && this.theme != Theme.Dark)\r\n        {\r\n            // TODO: Use es2017 in future with Object.values(Theme).includes(this.theme) to do this check\r\n            throw new Error(`Invalid theme configuration for ng-chat. \"${this.theme}\" is not a valid theme value.`);\r\n        }\r\n    }\r\n\r\n    // Sends a request to load the friends list\r\n    private fetchFriendsList(isBootstrapping: boolean): void\r\n    {\r\n        this.adapter.listFriends()\r\n        .pipe(\r\n            map((participantsResponse: ParticipantResponse[]) => {\r\n                this.participantsResponse = participantsResponse;\r\n\r\n                this.participants = participantsResponse.map((response: ParticipantResponse) => {\r\n                    return response.participant;\r\n                });\r\n            })\r\n        ).subscribe(() => {\r\n            if (isBootstrapping)\r\n            {\r\n                this.restoreWindowsState();\r\n            }\r\n        });\r\n    }\r\n\r\n    fetchMessageHistory(window: Window) {\r\n        // Not ideal but will keep this until we decide if we are shipping pagination with the default adapter\r\n        if (this.adapter instanceof PagedHistoryChatAdapter)\r\n        {\r\n            window.isLoadingHistory = true;\r\n\r\n            this.adapter.getMessageHistoryByPage(window.participant.id, this.historyPageSize, ++window.historyPage)\r\n            .pipe(\r\n                map((result: Message[]) => {\r\n                    result.forEach((message) => this.assertMessageType(message));\r\n\r\n                    window.messages = result.concat(window.messages);\r\n                    window.isLoadingHistory = false;\r\n\r\n                    const direction: ScrollDirection = (window.historyPage == 1) ? ScrollDirection.Bottom : ScrollDirection.Top;\r\n                    window.hasMoreMessages = result.length == this.historyPageSize;\r\n\r\n                    setTimeout(() => this.onFetchMessageHistoryLoaded(result, window, direction, true));\r\n                })\r\n            ).subscribe();\r\n        }\r\n        else\r\n        {\r\n            this.adapter.getMessageHistory(window.participant.id)\r\n            .pipe(\r\n                map((result: Message[]) => {\r\n                    result.forEach((message) => this.assertMessageType(message));\r\n\r\n                    window.messages = result.concat(window.messages);\r\n                    window.isLoadingHistory = false;\r\n\r\n                    setTimeout(() => this.onFetchMessageHistoryLoaded(result, window, ScrollDirection.Bottom));\r\n                })\r\n            ).subscribe();\r\n        }\r\n    }\r\n\r\n    private onFetchMessageHistoryLoaded(messages: Message[], window: Window, direction: ScrollDirection, forceMarkMessagesAsSeen: boolean = false): void\r\n    {\r\n        this.scrollChatWindow(window, direction)\r\n\r\n        if (window.hasFocus || forceMarkMessagesAsSeen)\r\n        {\r\n            const unseenMessages = messages.filter(m => !m.dateSeen);\r\n\r\n            this.markMessagesAsRead(unseenMessages);\r\n        }\r\n    }\r\n\r\n    // Updates the friends list via the event handler\r\n    private onFriendsListChanged(participantsResponse: ParticipantResponse[]): void\r\n    {\r\n        if (participantsResponse)\r\n        {\r\n            this.participantsResponse = participantsResponse;\r\n\r\n            this.participants = participantsResponse.map((response: ParticipantResponse) => {\r\n                return response.participant;\r\n            });\r\n\r\n            this.participantsInteractedWith = [];\r\n        }\r\n    }\r\n\r\n    // Handles received messages by the adapter\r\n    private onMessageReceived(participant: IChatParticipant, message: Message)\r\n    {\r\n        if (participant && message)\r\n        {\r\n            const chatWindow = this.openChatWindow(participant);\r\n\r\n            this.assertMessageType(message);\r\n\r\n            if (!chatWindow[1] || !this.historyEnabled){\r\n                chatWindow[0].messages.push(message);\r\n\r\n                this.scrollChatWindow(chatWindow[0], ScrollDirection.Bottom);\r\n\r\n                if (chatWindow[0].hasFocus)\r\n                {\r\n                    this.markMessagesAsRead([message]);\r\n                }\r\n            }\r\n\r\n            this.emitMessageSound(chatWindow[0]);\r\n\r\n            // Github issue #58\r\n            // Do not push browser notifications with message content for privacy purposes if the 'maximizeWindowOnNewMessage' setting is off and this is a new chat window.\r\n            if (this.maximizeWindowOnNewMessage || (!chatWindow[1] && !chatWindow[0].isCollapsed))\r\n            {\r\n                // Some messages are not pushed because they are loaded by fetching the history hence why we supply the message here\r\n                this.emitBrowserNotification(chatWindow[0], message);\r\n            }\r\n        }\r\n    }\r\n\r\n    onParticipantClickedFromFriendsList(participant: IChatParticipant): void {\r\n        this.openChatWindow(participant, true, true);\r\n    }\r\n\r\n    private cancelOptionPrompt(): void {\r\n        if (this.currentActiveOption)\r\n        {\r\n            this.currentActiveOption.isActive = false;\r\n            this.currentActiveOption = null;\r\n        }\r\n    }\r\n\r\n    onOptionPromptCanceled(): void {\r\n        this.cancelOptionPrompt();\r\n    }\r\n\r\n    onOptionPromptConfirmed(event: any): void {\r\n        // For now this is fine as there is only one option available. Introduce option types and type checking if a new option is added.\r\n        this.confirmNewGroup(event);\r\n\r\n        // Canceling current state\r\n        this.cancelOptionPrompt();\r\n    }\r\n\r\n    private confirmNewGroup(users: User[]): void {\r\n        const newGroup = new Group(users);\r\n\r\n        this.openChatWindow(newGroup);\r\n\r\n        if (this.groupAdapter)\r\n        {\r\n            this.groupAdapter.groupCreated(newGroup);\r\n        }\r\n    }\r\n\r\n    // Opens a new chat whindow. Takes care of available viewport\r\n    // Works for opening a chat window for an user or for a group\r\n    // Returns => [Window: Window object reference, boolean: Indicates if this window is a new chat window]\r\n    private openChatWindow(participant: IChatParticipant, focusOnNewWindow: boolean = false, invokedByUserClick: boolean = false): [Window, boolean]\r\n    {\r\n        // Is this window opened?\r\n        const openedWindow = this.windows.find(x => x.participant.id == participant.id);\r\n\r\n        if (!openedWindow)\r\n        {\r\n            if (invokedByUserClick)\r\n            {\r\n                this.onParticipantClicked.emit(participant);\r\n            }\r\n\r\n            // Refer to issue #58 on Github\r\n            const collapseWindow = invokedByUserClick ? false : !this.maximizeWindowOnNewMessage;\r\n\r\n            const newChatWindow: Window = new Window(participant, this.historyEnabled, collapseWindow);\r\n\r\n            // Loads the chat history via an RxJs Observable\r\n            if (this.historyEnabled)\r\n            {\r\n                this.fetchMessageHistory(newChatWindow);\r\n            }\r\n\r\n            this.windows.unshift(newChatWindow);\r\n\r\n            // Is there enough space left in the view port ? but should be displayed in mobile if option is enabled\r\n            if (!this.isViewportOnMobileEnabled) {\r\n                if (this.windows.length * this.windowSizeFactor >= this.viewPortTotalArea - (!this.hideFriendsList ? this.friendsListWidth : 0)) {\r\n                    this.windows.pop();\r\n                }\r\n            }\r\n\r\n            this.updateWindowsState(this.windows);\r\n\r\n            if (focusOnNewWindow && !collapseWindow)\r\n            {\r\n                this.focusOnWindow(newChatWindow);\r\n            }\r\n\r\n            this.participantsInteractedWith.push(participant);\r\n            this.onParticipantChatOpened.emit(participant);\r\n\r\n            return [newChatWindow, true];\r\n        }\r\n        else\r\n        {\r\n            // Returns the existing chat window\r\n            return [openedWindow, false];\r\n        }\r\n    }\r\n\r\n    // Focus on the input element of the supplied window\r\n    private focusOnWindow(window: Window, callback: Function = () => {}) : void\r\n    {\r\n        const windowIndex = this.windows.indexOf(window);\r\n        if (windowIndex >= 0)\r\n        {\r\n            setTimeout(() => {\r\n                if (this.chatWindows)\r\n                {\r\n                    const chatWindowToFocus = this.chatWindows.toArray()[windowIndex];\r\n\r\n                    chatWindowToFocus.chatWindowInput.nativeElement.focus();\r\n                }\r\n\r\n                callback();\r\n            });\r\n        }\r\n    }\r\n\r\n    private assertMessageType(message: Message): void {\r\n        // Always fallback to \"Text\" messages to avoid rendenring issues\r\n        if (!message.type)\r\n        {\r\n            message.type = MessageType.Text;\r\n        }\r\n    }\r\n\r\n    // Marks all messages provided as read with the current time.\r\n    markMessagesAsRead(messages: Message[]): void\r\n    {\r\n        const currentDate = new Date();\r\n\r\n        messages.forEach((msg)=>{\r\n            msg.dateSeen = currentDate;\r\n        });\r\n\r\n        this.onMessagesSeen.emit(messages);\r\n    }\r\n\r\n    // Buffers audio file (For component's bootstrapping)\r\n    private bufferAudioFile(): void {\r\n        if (this.audioSource && this.audioSource.length > 0)\r\n        {\r\n            this.audioFile = new Audio();\r\n            this.audioFile.src = this.audioSource;\r\n            this.audioFile.load();\r\n        }\r\n    }\r\n\r\n    // Emits a message notification audio if enabled after every message received\r\n    private emitMessageSound(window: Window): void\r\n    {\r\n        if (this.audioEnabled && !window.hasFocus && this.audioFile) {\r\n            this.audioFile.play();\r\n        }\r\n    }\r\n\r\n    // Emits a browser notification\r\n    private emitBrowserNotification(window: Window, message: Message): void\r\n    {\r\n        if (this.browserNotificationsBootstrapped && !window.hasFocus && message) {\r\n            const notification = new Notification(`${this.localization.browserNotificationTitle} ${window.participant.displayName}`, {\r\n                'body': message.message,\r\n                'icon': this.browserNotificationIconSource\r\n            });\r\n\r\n            setTimeout(() => {\r\n                notification.close();\r\n            }, message.message.length <= 50 ? 5000 : 7000); // More time to read longer messages\r\n        }\r\n    }\r\n\r\n    // Saves current windows state into local storage if persistence is enabled\r\n    private updateWindowsState(windows: Window[]): void\r\n    {\r\n        if (this.persistWindowsState)\r\n        {\r\n            const participantIds = windows.map((w) => {\r\n                return w.participant.id;\r\n            });\r\n\r\n            localStorage.setItem(this.localStorageKey, JSON.stringify(participantIds));\r\n        }\r\n    }\r\n\r\n    private restoreWindowsState(): void\r\n    {\r\n        try\r\n        {\r\n            if (this.persistWindowsState)\r\n            {\r\n                const stringfiedParticipantIds = localStorage.getItem(this.localStorageKey);\r\n\r\n                if (stringfiedParticipantIds && stringfiedParticipantIds.length > 0)\r\n                {\r\n                    const participantIds = <number[]>JSON.parse(stringfiedParticipantIds);\r\n\r\n                    const participantsToRestore = this.participants.filter(u => participantIds.indexOf(u.id) >= 0);\r\n\r\n                    participantsToRestore.forEach((participant) => {\r\n                        this.openChatWindow(participant);\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        catch (ex)\r\n        {\r\n            console.error(`An error occurred while restoring ng-chat windows state. Details: ${ex}`);\r\n        }\r\n    }\r\n\r\n    // Gets closest open window if any. Most recent opened has priority (Right)\r\n    private getClosestWindow(window: Window): Window | undefined\r\n    {\r\n        const index = this.windows.indexOf(window);\r\n\r\n        if (index > 0)\r\n        {\r\n            return this.windows[index - 1];\r\n        }\r\n        else if (index == 0 && this.windows.length > 1)\r\n        {\r\n            return this.windows[index + 1];\r\n        }\r\n    }\r\n\r\n    private closeWindow(window: Window): void\r\n    {\r\n        const index = this.windows.indexOf(window);\r\n\r\n        this.windows.splice(index, 1);\r\n\r\n        this.updateWindowsState(this.windows);\r\n\r\n        this.onParticipantChatClosed.emit(window.participant);\r\n    }\r\n\r\n    private getChatWindowComponentInstance(targetWindow: Window): NgChatWindowComponent | null {\r\n        const windowIndex = this.windows.indexOf(targetWindow);\r\n\r\n        if (this.chatWindows){\r\n            let targetWindow = this.chatWindows.toArray()[windowIndex];\r\n\r\n            return targetWindow;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    // Scrolls a chat window message flow to the bottom\r\n    private scrollChatWindow(window: Window, direction: ScrollDirection): void\r\n    {\r\n        const chatWindow = this.getChatWindowComponentInstance(window);\r\n\r\n        if (chatWindow){\r\n            chatWindow.scrollChatWindow(window, direction);\r\n        }\r\n    }\r\n\r\n    onWindowMessagesSeen(messagesSeen: Message[]): void {\r\n        this.markMessagesAsRead(messagesSeen);\r\n    }\r\n\r\n    onWindowChatClosed(payload: { closedWindow: Window, closedViaEscapeKey: boolean }): void {\r\n        const { closedWindow, closedViaEscapeKey } = payload;\r\n\r\n        if (closedViaEscapeKey) {\r\n            let closestWindow = this.getClosestWindow(closedWindow);\r\n\r\n            if (closestWindow)\r\n            {\r\n                this.focusOnWindow(closestWindow, () => { this.closeWindow(closedWindow); });\r\n            }\r\n            else\r\n            {\r\n                this.closeWindow(closedWindow);\r\n            }\r\n        }\r\n        else {\r\n            this.closeWindow(closedWindow);\r\n        }\r\n    }\r\n\r\n    onWindowTabTriggered(payload: { triggeringWindow: Window, shiftKeyPressed: boolean }): void {\r\n        const { triggeringWindow, shiftKeyPressed } = payload;\r\n\r\n        const currentWindowIndex = this.windows.indexOf(triggeringWindow);\r\n        let windowToFocus = this.windows[currentWindowIndex + (shiftKeyPressed ? 1 : -1)]; // Goes back on shift + tab\r\n\r\n        if (!windowToFocus)\r\n        {\r\n            // Edge windows, go to start or end\r\n            windowToFocus = this.windows[currentWindowIndex > 0 ? 0 : this.chatWindows.length - 1];\r\n        }\r\n\r\n        this.focusOnWindow(windowToFocus);\r\n    }\r\n\r\n    onWindowMessageSent(messageSent: Message): void {\r\n        this.adapter.sendMessage(messageSent);\r\n    }\r\n\r\n    onWindowOptionTriggered(option: IChatOption): void {\r\n        this.currentActiveOption = option;\r\n    }\r\n\r\n    triggerOpenChatWindow(user: User): void {\r\n        if (user)\r\n        {\r\n            this.openChatWindow(user);\r\n        }\r\n    }\r\n\r\n    triggerCloseChatWindow(userId: any): void {\r\n        const openedWindow = this.windows.find(x => x.participant.id == userId);\r\n\r\n        if (openedWindow)\r\n        {\r\n            this.closeWindow(openedWindow);\r\n        }\r\n    }\r\n\r\n    triggerToggleChatWindowVisibility(userId: any): void {\r\n        const openedWindow = this.windows.find(x => x.participant.id == userId);\r\n\r\n        if (openedWindow)\r\n        {\r\n            const chatWindow = this.getChatWindowComponentInstance(openedWindow);\r\n\r\n            if (chatWindow){\r\n                chatWindow.onChatWindowClicked(openedWindow);\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\n\r\nlet emojiDictionary = [\r\n    { patterns: [':)', ':-)', '=)'], unicode: '' },\r\n    { patterns: [':D', ':-D', '=D'], unicode: '' },\r\n    { patterns: [':(', ':-(', '=('], unicode: '' },\r\n    { patterns: [':|', ':-|', '=|'], unicode: '' },\r\n    { patterns: [':*', ':-*', '=*'], unicode: '' },\r\n    { patterns: ['T_T', 'T.T'], unicode: '' },\r\n    { patterns: [':O', ':-O', '=O', ':o', ':-o', '=o'], unicode: '' },\r\n    { patterns: [':P', ':-P', '=P', ':p', ':-p', '=p'], unicode: '' },\r\n    { patterns: ['>.<'], unicode: '' },\r\n    { patterns: ['@.@'], unicode: '' },\r\n    { patterns: ['*.*'], unicode: '' },\r\n    { patterns: ['<3'], unicode: '' },\r\n    { patterns: ['^.^'], unicode: '' },\r\n    { patterns: [':+1'], unicode: '' },\r\n    { patterns: [':-1'], unicode: '' }\r\n];\r\n\r\n/*\r\n * Transforms common emoji text to UTF encoded emojis\r\n*/\r\n@Pipe({name: 'emojify'})\r\nexport class EmojifyPipe implements PipeTransform {\r\n    transform(message: string, pipeEnabled: boolean): string {\r\n        if (pipeEnabled && message && message.length > 1) {  \r\n            emojiDictionary.forEach(emoji => {\r\n                emoji.patterns.forEach(pattern => {\r\n                    message = message.replace(pattern, emoji.unicode);\r\n                })\r\n            });\r\n        }\r\n\r\n    return message;\r\n  }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\n\r\n/*\r\n * Transforms text containing URLs or E-mails to valid links/mailtos\r\n*/\r\n@Pipe({name: 'linkfy'})\r\nexport class LinkfyPipe implements PipeTransform {\r\n    transform(message: string, pipeEnabled: boolean): string {\r\n        if (pipeEnabled && message && message.length > 1)\r\n        {\r\n            let replacedText;\r\n            let replacePatternProtocol;\r\n            let replacePatternWWW;\r\n            let replacePatternMailTo;\r\n\r\n            // URLs starting with http://, https://, or ftp://\r\n            replacePatternProtocol = /(\\b(https?|ftp):\\/\\/[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|])/gim;\r\n            replacedText = message.replace(replacePatternProtocol, '<a href=\"$1\" target=\"_blank\">$1</a>');\r\n\r\n            // URLs starting with \"www.\" (ignoring // before it).\r\n            replacePatternWWW = /(^|[^\\/])(www\\.[\\S]+(\\b|$))/gim;\r\n            replacedText = replacedText.replace(replacePatternWWW, '$1<a href=\"http://$2\" target=\"_blank\">$2</a>');\r\n\r\n            // Change email addresses to mailto:: links.\r\n            replacePatternMailTo = /(([a-zA-Z0-9\\-\\_\\.])+@[a-zA-Z\\_]+?(\\.[a-zA-Z]{2,6})+)/gim;\r\n            replacedText = replacedText.replace(replacePatternMailTo, '<a href=\"mailto:$1\">$1</a>');\r\n\r\n            return replacedText;\r\n        }\r\n        else\r\n            return message;\r\n    } \r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { DomSanitizer, SafeResourceUrl  } from '@angular/platform-browser';\r\n\r\n/*\r\n * Sanitizes an URL resource\r\n*/\r\n@Pipe({name: 'sanitize'})\r\nexport class SanitizePipe implements PipeTransform {\r\n    constructor(protected sanitizer: DomSanitizer) {}\r\n\r\n    transform(url: string): SafeResourceUrl {\r\n        return this.sanitizer.bypassSecurityTrustResourceUrl(url);\r\n    }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { Group } from \"../core/group\";\r\nimport { ChatParticipantType } from \"../core/chat-participant-type.enum\";\r\nimport { IChatParticipant } from \"../core/chat-participant\";\r\nimport { Message } from \"../core/message\";\r\n\r\n/*\r\n * Renders the display name of a participant in a group based on who's sent the message\r\n*/\r\n@Pipe({name: 'groupMessageDisplayName'})\r\nexport class GroupMessageDisplayNamePipe implements PipeTransform {\r\n    transform(participant: IChatParticipant, message: Message): string {\r\n        if (participant && participant.participantType == ChatParticipantType.Group)\r\n        {\r\n            let group = participant as Group;\r\n            let userIndex = group.chattingTo.findIndex(x => x.id == message.fromId);\r\n\r\n            return group.chattingTo[userIndex >= 0 ? userIndex : 0].displayName;\r\n        }\r\n        else\r\n            return \"\";\r\n    } \r\n}\r\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\r\nimport { IChatOption } from '../../core/chat-option';\r\n\r\n@Component({\r\n    selector: 'ng-chat-options',\r\n    templateUrl: './ng-chat-options.component.html',\r\n    styleUrls: ['./ng-chat-options.component.css']\r\n})\r\nexport class NgChatOptionsComponent {\r\n\r\n\tconstructor() { }\r\n\r\n\t@Input()\r\n\tpublic options: IChatOption[];\r\n\r\n\t@Input()\r\n\tpublic activeOptionTracker: IChatOption;\r\n\r\n\t@Output()\r\n\tpublic activeOptionTrackerChange: EventEmitter<IChatOption> = new EventEmitter<IChatOption>();\r\n\r\n\tonOptionClicked(option: IChatOption): void\r\n\t{\r\n\t\toption.isActive = true;\r\n\r\n\t\tif (option.action) {    \r\n\t\t\toption.action(option.chattingTo);   \r\n\t\t}\r\n\r\n\t\tthis.activeOptionTrackerChange.emit(option);\r\n\t}\r\n}\r\n","import { Window } from './window';\r\n\r\nexport class MessageCounter\r\n{\r\n    public static formatUnreadMessagesTotal(totalUnreadMessages: number): string\r\n    {\r\n        if (totalUnreadMessages > 0){\r\n\r\n            if (totalUnreadMessages > 99) \r\n                return  \"99+\";\r\n            else\r\n                return String(totalUnreadMessages); \r\n        }\r\n\r\n        // Empty fallback.\r\n        return \"\";\r\n    }\r\n\r\n    /**\r\n     * Returns a formatted string containing the total unread messages of a chat window.\r\n     * @param window The window instance to count the unread total messages.\r\n     * @param currentUserId The current chat instance user id. In this context it would be the sender.\r\n     */\r\n    public static unreadMessagesTotal(window: Window, currentUserId: any): string\r\n    {\r\n        let totalUnreadMessages = 0;\r\n\r\n        if (window){\r\n            totalUnreadMessages = window.messages.filter(x => x.fromId != currentUserId && !x.dateSeen).length;\r\n        }\r\n            \r\n        return MessageCounter.formatUnreadMessagesTotal(totalUnreadMessages);\r\n    }\r\n}\r\n","import { ChatParticipantStatus } from './chat-participant-status.enum';\r\nimport { Localization } from './localization'\r\n \r\nexport function chatParticipantStatusDescriptor(status: ChatParticipantStatus, localization: Localization) {\r\n    const currentStatus = ChatParticipantStatus[status].toString().toLowerCase();\r\n    \r\n    return localization.statusDescription[currentStatus];\r\n}","import { Component, Input, Output, EventEmitter, ViewEncapsulation, OnChanges, SimpleChanges } from '@angular/core';\r\n\r\nimport { Localization } from '../../core/localization';\r\nimport { IChatOption } from '../../core/chat-option';\r\nimport { ChatParticipantStatus } from \"../../core/chat-participant-status.enum\";\r\nimport { IChatParticipant } from \"../../core/chat-participant\";\r\nimport { User } from \"../../core/user\";\r\nimport { Window } from \"../../core/window\";\r\nimport { ParticipantResponse } from \"../../core/participant-response\";\r\nimport { MessageCounter } from \"../../core/message-counter\";\r\nimport { chatParticipantStatusDescriptor } from '../../core/chat-participant-status-descriptor';\r\n\r\n@Component({\r\n    selector: 'ng-chat-friends-list',\r\n    templateUrl: './ng-chat-friends-list.component.html',\r\n    styleUrls: ['./ng-chat-friends-list.component.css'],\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\nexport class NgChatFriendsListComponent implements OnChanges {\r\n    constructor() { }\r\n\r\n    @Input()\r\n    public participants: IChatParticipant[];\r\n\r\n    @Input()\r\n    public participantsResponse: ParticipantResponse[];\r\n\r\n    @Input()\r\n    public participantsInteractedWith: IChatParticipant[] = [];\r\n\r\n    @Input()\r\n    public windows: Window[];\r\n\r\n    @Input()\r\n    public userId: any;\r\n\r\n    @Input()\r\n    public localization: Localization;\r\n\r\n    @Input()\r\n    public shouldDisplay: boolean;\r\n\r\n    @Input()\r\n    public isCollapsed: boolean;\r\n\r\n    @Input()\r\n    public searchEnabled: boolean;\r\n\r\n    @Input()\r\n    public currentActiveOption: IChatOption | null;\r\n\r\n    @Output()\r\n    public onParticipantClicked: EventEmitter<IChatParticipant> = new EventEmitter();\r\n\r\n    @Output()\r\n    public onOptionPromptCanceled: EventEmitter<any> = new EventEmitter();\r\n\r\n    @Output()\r\n    public onOptionPromptConfirmed: EventEmitter<any> = new EventEmitter();\r\n\r\n    public selectedUsersFromFriendsList: User[] = [];\r\n\r\n    public searchInput: string = '';\r\n\r\n    // Exposes enums and functions for the ng-template\r\n    public ChatParticipantStatus = ChatParticipantStatus;\r\n    public chatParticipantStatusDescriptor = chatParticipantStatusDescriptor;\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n        if (this.currentActiveOption) {\r\n            const currentOptionTriggeredBy = this.currentActiveOption && this.currentActiveOption.chattingTo.participant.id;\r\n            const isActivatedUserInSelectedList = (this.selectedUsersFromFriendsList.filter(item => item.id == currentOptionTriggeredBy)).length > 0;\r\n\r\n            if (!isActivatedUserInSelectedList) {\r\n                this.selectedUsersFromFriendsList = this.selectedUsersFromFriendsList.concat(this.currentActiveOption.chattingTo.participant as User);\r\n            }\r\n        }\r\n    }\r\n\r\n    get filteredParticipants(): IChatParticipant[]\r\n    {\r\n        if (this.searchInput.length > 0){\r\n            // Searches in the friend list by the inputted search string\r\n            return this.participants.filter(x => x.displayName.toUpperCase().includes(this.searchInput.toUpperCase()));\r\n        }\r\n\r\n        return this.participants;\r\n    }\r\n\r\n    isUserSelectedFromFriendsList(user: User) : boolean\r\n    {\r\n        return (this.selectedUsersFromFriendsList.filter(item => item.id == user.id)).length > 0\r\n    }\r\n\r\n    unreadMessagesTotalByParticipant(participant: IChatParticipant): string\r\n    {\r\n        let openedWindow = this.windows.find(x => x.participant.id == participant.id);\r\n\r\n        if (openedWindow){\r\n            return MessageCounter.unreadMessagesTotal(openedWindow, this.userId);\r\n        }\r\n        else\r\n        {\r\n            let totalUnreadMessages = this.participantsResponse\r\n                .filter(x => x.participant.id == participant.id && !this.participantsInteractedWith.find(u => u.id == participant.id) && x.metadata && x.metadata.totalUnreadMessages > 0)\r\n                .map((participantResponse) => {\r\n                    return participantResponse.metadata.totalUnreadMessages\r\n                })[0];\r\n\r\n            return MessageCounter.formatUnreadMessagesTotal(totalUnreadMessages);\r\n        }\r\n    }\r\n\r\n    cleanUpUserSelection = () => this.selectedUsersFromFriendsList = [];\r\n\r\n    // Toggle friends list visibility\r\n    onChatTitleClicked(): void\r\n    {\r\n        this.isCollapsed = !this.isCollapsed;\r\n    }\r\n\r\n    onFriendsListCheckboxChange(selectedUser: User, isChecked: boolean): void\r\n    {\r\n        if(isChecked) {\r\n            this.selectedUsersFromFriendsList.push(selectedUser);\r\n        } \r\n        else \r\n        {\r\n            this.selectedUsersFromFriendsList.splice(this.selectedUsersFromFriendsList.indexOf(selectedUser), 1);\r\n        }\r\n    }\r\n\r\n    onUserClick(clickedUser: User): void\r\n    {\r\n        this.onParticipantClicked.emit(clickedUser);\r\n    }\r\n\r\n    onFriendsListActionCancelClicked(): void\r\n    {\r\n        this.onOptionPromptCanceled.emit();\r\n        this.cleanUpUserSelection();\r\n    }\r\n\r\n    onFriendsListActionConfirmClicked() : void\r\n    {\r\n        this.onOptionPromptConfirmed.emit(this.selectedUsersFromFriendsList);\r\n        this.cleanUpUserSelection();\r\n    }\r\n}\r\n","import { Component, Input, Output, EventEmitter, ViewEncapsulation, ViewChild, ElementRef } from '@angular/core';\r\n\r\nimport { Message } from \"../../core/message\";\r\nimport { MessageType } from \"../../core/message-type.enum\";\r\nimport { Window } from \"../../core/window\";\r\nimport { ChatParticipantStatus } from \"../../core/chat-participant-status.enum\";\r\nimport { ScrollDirection } from \"../../core/scroll-direction.enum\";\r\nimport { Localization } from '../../core/localization';\r\nimport { IFileUploadAdapter } from '../../core/file-upload-adapter';\r\nimport { IChatOption } from '../../core/chat-option';\r\nimport { Group } from \"../../core/group\";\r\nimport { ChatParticipantType } from \"../../core/chat-participant-type.enum\";\r\nimport { IChatParticipant } from \"../../core/chat-participant\";\r\nimport { MessageCounter } from \"../../core/message-counter\";\r\nimport { chatParticipantStatusDescriptor } from '../../core/chat-participant-status-descriptor';\r\n\r\n@Component({\r\n    selector: 'ng-chat-window',\r\n    templateUrl: './ng-chat-window.component.html',\r\n    styleUrls: ['./ng-chat-window.component.css'],\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\nexport class NgChatWindowComponent {\r\n    constructor() { }\r\n\r\n    @Input()\r\n    public fileUploadAdapter: IFileUploadAdapter;\r\n\r\n    @Input()\r\n    public window: Window;\r\n\r\n    @Input()\r\n    public userId: any;\r\n\r\n    @Input()\r\n    public localization: Localization;\r\n\r\n    @Input()\r\n    public showOptions: boolean;\r\n\r\n    @Input()    \r\n    public emojisEnabled: boolean = true;\r\n\r\n    @Input()    \r\n    public linkfyEnabled: boolean = true;\r\n\r\n    @Input()\r\n    public showMessageDate: boolean = true;\r\n\r\n    @Input()\r\n    public messageDatePipeFormat: string = \"short\";\r\n\r\n    @Input()\r\n    public hasPagedHistory: boolean = true;\r\n\r\n    @Output()\r\n    public onChatWindowClosed: EventEmitter<{ closedWindow: Window, closedViaEscapeKey: boolean}> = new EventEmitter();\r\n\r\n    @Output()\r\n    public onMessagesSeen: EventEmitter<Message[]> = new EventEmitter();\r\n\r\n    @Output()\r\n    public onMessageSent: EventEmitter<Message> = new EventEmitter();\r\n\r\n    @Output()\r\n    public onTabTriggered: EventEmitter<{ triggeringWindow: Window, shiftKeyPressed: boolean }> = new EventEmitter();\r\n\r\n    @Output()\r\n    public onOptionTriggered: EventEmitter<IChatOption> = new EventEmitter();\r\n\r\n    @Output()\r\n    public onLoadHistoryTriggered: EventEmitter<Window> = new EventEmitter();\r\n\r\n    @ViewChild('chatMessages') chatMessages: any;\r\n    @ViewChild('nativeFileInput') nativeFileInput: ElementRef;\r\n    @ViewChild('chatWindowInput') chatWindowInput: any;\r\n\r\n    // File upload state\r\n    public fileUploadersInUse: string[] = []; // Id bucket of uploaders in use\r\n\r\n    // Exposes enums and functions for the ng-template\r\n    public ChatParticipantType = ChatParticipantType;\r\n    public ChatParticipantStatus = ChatParticipantStatus;\r\n    public MessageType = MessageType;\r\n    public chatParticipantStatusDescriptor = chatParticipantStatusDescriptor;\r\n\r\n    defaultWindowOptions(currentWindow: Window): IChatOption[]\r\n    {\r\n        if (this.showOptions && currentWindow.participant.participantType == ChatParticipantType.User)\r\n        {\r\n            return [{\r\n                isActive: false,\r\n                chattingTo: currentWindow,\r\n                validateContext: (participant: IChatParticipant) => {\r\n                    return participant.participantType == ChatParticipantType.User;\r\n                },\r\n                displayLabel: 'Add People' // TODO: Localize this\r\n            }];\r\n        }\r\n\r\n        return [];\r\n    }\r\n\r\n    // Asserts if a user avatar is visible in a chat cluster\r\n    isAvatarVisible(window: Window, message: Message, index: number): boolean\r\n    {\r\n        if (message.fromId != this.userId){\r\n            if (index == 0){\r\n                return true; // First message, good to show the thumbnail\r\n            }\r\n            else{\r\n                // Check if the previous message belongs to the same user, if it belongs there is no need to show the avatar again to form the message cluster\r\n                if (window.messages[index - 1].fromId != message.fromId){\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    getChatWindowAvatar(participant: IChatParticipant, message: Message): string | null\r\n    {\r\n        if (participant.participantType == ChatParticipantType.User)\r\n        {\r\n            return participant.avatar;\r\n        }\r\n        else if (participant.participantType == ChatParticipantType.Group)\r\n        {\r\n            let group = participant as Group;\r\n            let userIndex = group.chattingTo.findIndex(x => x.id == message.fromId);\r\n\r\n            return group.chattingTo[userIndex >= 0 ? userIndex : 0].avatar;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    isUploadingFile(window: Window): boolean\r\n    {\r\n        const fileUploadInstanceId = this.getUniqueFileUploadInstanceId(window);\r\n\r\n        return this.fileUploadersInUse.indexOf(fileUploadInstanceId) > -1;\r\n    }\r\n\r\n    // Generates a unique file uploader id for each participant\r\n    getUniqueFileUploadInstanceId(window: Window): string\r\n    {\r\n        if (window && window.participant)\r\n        {\r\n            return `ng-chat-file-upload-${window.participant.id}`;\r\n        }\r\n        \r\n        return 'ng-chat-file-upload';\r\n    }\r\n\r\n    unreadMessagesTotal(window: Window): string\r\n    {           \r\n        return MessageCounter.unreadMessagesTotal(window, this.userId);\r\n    }\r\n\r\n    // Scrolls a chat window message flow to the bottom\r\n    scrollChatWindow(window: Window, direction: ScrollDirection): void\r\n    {\r\n        if (!window.isCollapsed){\r\n            setTimeout(() => {\r\n                if (this.chatMessages){\r\n                    let element = this.chatMessages.nativeElement;\r\n                    let position = ( direction === ScrollDirection.Top ) ? 0 : element.scrollHeight;\r\n                    element.scrollTop = position;\r\n                }\r\n            }); \r\n        }\r\n    }\r\n\r\n    activeOptionTrackerChange(option: IChatOption): void {\r\n        this.onOptionTriggered.emit(option);\r\n    }\r\n\r\n    // Triggers native file upload for file selection from the user\r\n    triggerNativeFileUpload(window: Window): void\r\n    {\r\n        if (window)\r\n        {\r\n            if (this.nativeFileInput) this.nativeFileInput.nativeElement.click();\r\n        }\r\n    }\r\n\r\n    // Toggles a window focus on the focus/blur of a 'newMessage' input\r\n    toggleWindowFocus(window: Window): void\r\n    {\r\n        window.hasFocus = !window.hasFocus;\r\n        if(window.hasFocus) {\r\n            const unreadMessages = window.messages\r\n                .filter(message => message.dateSeen == null \r\n                    && (message.toId == this.userId || window.participant.participantType === ChatParticipantType.Group));\r\n            \r\n            if (unreadMessages && unreadMessages.length > 0)\r\n            {\r\n                this.onMessagesSeen.emit(unreadMessages);\r\n            }\r\n        }\r\n    }\r\n\r\n    markMessagesAsRead(messages: Message[]): void \r\n    {\r\n        this.onMessagesSeen.emit(messages);\r\n    }\r\n\r\n    fetchMessageHistory(window: Window): void {\r\n        this.onLoadHistoryTriggered.emit(window);\r\n    }\r\n\r\n    // Closes a chat window via the close 'X' button\r\n    onCloseChatWindow(): void \r\n    {\r\n        this.onChatWindowClosed.emit({ closedWindow: this.window, closedViaEscapeKey: false });\r\n    }\r\n\r\n    /*  Monitors pressed keys on a chat window\r\n        - Dispatches a message when the ENTER key is pressed\r\n        - Tabs between windows on TAB or SHIFT + TAB\r\n        - Closes the current focused window on ESC\r\n    */\r\n   onChatInputTyped(event: any, window: Window): void\r\n   {\r\n       switch (event.keyCode)\r\n       {\r\n           case 13:\r\n               if (window.newMessage && window.newMessage.trim() != \"\")\r\n               {\r\n                   let message = new Message();\r\n            \r\n                   message.fromId = this.userId;\r\n                   message.toId = window.participant.id;\r\n                   message.message = window.newMessage;\r\n                   message.dateSent = new Date();\r\n       \r\n                   window.messages.push(message);\r\n       \r\n                   this.onMessageSent.emit(message);\r\n       \r\n                   window.newMessage = \"\"; // Resets the new message input\r\n       \r\n                   this.scrollChatWindow(window, ScrollDirection.Bottom);\r\n               }\r\n               break;\r\n           case 9:\r\n               event.preventDefault();\r\n\r\n               this.onTabTriggered.emit({ triggeringWindow: window, shiftKeyPressed: event.shiftKey });\r\n\r\n               break;\r\n           case 27:\r\n               this.onChatWindowClosed.emit({ closedWindow: window, closedViaEscapeKey: true });\r\n\r\n               break;\r\n       }\r\n   }\r\n\r\n    // Toggles a chat window visibility between maximized/minimized\r\n    onChatWindowClicked(window: Window): void\r\n    {\r\n        window.isCollapsed = !window.isCollapsed;\r\n        this.scrollChatWindow(window, ScrollDirection.Bottom);\r\n    }\r\n\r\n    private clearInUseFileUploader(fileUploadInstanceId: string): void\r\n    {\r\n        const uploaderInstanceIdIndex = this.fileUploadersInUse.indexOf(fileUploadInstanceId);\r\n\r\n        if (uploaderInstanceIdIndex > -1) {\r\n            this.fileUploadersInUse.splice(uploaderInstanceIdIndex, 1);\r\n        }\r\n    }\r\n\r\n    // Handles file selection and uploads the selected file using the file upload adapter\r\n    onFileChosen(window: Window): void {\r\n        const fileUploadInstanceId = this.getUniqueFileUploadInstanceId(window);\r\n        const uploadElementRef = this.nativeFileInput;\r\n\r\n        if (uploadElementRef)\r\n        {\r\n            const file: File = uploadElementRef.nativeElement.files[0];\r\n\r\n            this.fileUploadersInUse.push(fileUploadInstanceId);\r\n\r\n            this.fileUploadAdapter.uploadFile(file, window.participant.id)\r\n                .subscribe(fileMessage => {\r\n                    this.clearInUseFileUploader(fileUploadInstanceId);\r\n\r\n                    fileMessage.fromId = this.userId;\r\n\r\n                    // Push file message to current user window   \r\n                    window.messages.push(fileMessage);\r\n        \r\n                    this.onMessageSent.emit(fileMessage);\r\n        \r\n                    this.scrollChatWindow(window, ScrollDirection.Bottom);\r\n\r\n                    // Resets the file upload element\r\n                    uploadElementRef.nativeElement.value = '';\r\n                }, (error) => {\r\n                    this.clearInUseFileUploader(fileUploadInstanceId);\r\n\r\n                    // Resets the file upload element\r\n                    uploadElementRef.nativeElement.value = '';\r\n\r\n                    // TODO: Invoke a file upload adapter error here\r\n                });\r\n        }\r\n    }\r\n}\r\n","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { HttpClientModule } from '@angular/common/http';\r\n\r\nimport { NgChat } from './ng-chat.component';\r\nimport { EmojifyPipe } from './pipes/emojify.pipe';\r\nimport { LinkfyPipe } from './pipes/linkfy.pipe';\r\nimport { SanitizePipe } from './pipes/sanitize.pipe';\r\nimport { GroupMessageDisplayNamePipe } from './pipes/group-message-display-name.pipe';\r\nimport { NgChatOptionsComponent } from './components/ng-chat-options/ng-chat-options.component';\r\nimport { NgChatFriendsListComponent } from './components/ng-chat-friends-list/ng-chat-friends-list.component';\r\nimport { NgChatWindowComponent } from './components/ng-chat-window/ng-chat-window.component';\r\n\r\n@NgModule({\r\n  imports: [CommonModule, FormsModule, HttpClientModule],\r\n  declarations: [\r\n    NgChat, \r\n    EmojifyPipe, \r\n    LinkfyPipe, \r\n    SanitizePipe, \r\n    GroupMessageDisplayNamePipe, \r\n    NgChatOptionsComponent, \r\n    NgChatFriendsListComponent, \r\n    NgChatWindowComponent\r\n  ],\r\n  exports: [NgChat]\r\n})\r\nexport class NgChatModule {\r\n}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n\nexport {NgChatFriendsListComponent as g} from './ng-chat/components/ng-chat-friends-list/ng-chat-friends-list.component';\nexport {NgChatOptionsComponent as f} from './ng-chat/components/ng-chat-options/ng-chat-options.component';\nexport {NgChatWindowComponent as h} from './ng-chat/components/ng-chat-window/ng-chat-window.component';\nexport {NgChat as a} from './ng-chat/ng-chat.component';\nexport {EmojifyPipe as b} from './ng-chat/pipes/emojify.pipe';\nexport {GroupMessageDisplayNamePipe as e} from './ng-chat/pipes/group-message-display-name.pipe';\nexport {LinkfyPipe as c} from './ng-chat/pipes/linkfy.pipe';\nexport {SanitizePipe as d} from './ng-chat/pipes/sanitize.pipe';"]}